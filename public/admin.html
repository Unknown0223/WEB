<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boshqaruv Paneli</title>
    
    <!-- Tashqi kutubxonalar -->
    <link href="https://cdn.webdatarocks.com/latest/webdatarocks.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="admin.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="admin-page">

    <div class="admin-layout">
        <!-- 1. YON PANEL (SIDEBAR ) -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="/" class="brand-logo">MANUS</a>
            </div>
            <nav class="sidebar-nav">
                <a href="#dashboard" class="nav-link active" data-page="dashboard">
                    <i data-feather="home"></i>
                    <span>Bosh Sahifa</span>
                </a>
                <a href="#pivot-reports" class="nav-link" data-page="pivot-reports">
                    <i data-feather="bar-chart-2"></i>
                    <span>Interaktiv Hisobotlar</span>
                </a>
                <a href="#users" class="nav-link" data-page="users">
                    <i data-feather="users"></i>
                    <span>Foydalanuvchilar</span>
                </a>
                <a href="#table-settings" class="nav-link" data-page="table-settings">
                    <i data-feather="grid"></i>
                    <span>Jadval Sozlamalari</span>
                </a>
                <a href="#telegram" class="nav-link" data-page="telegram">
                    <i data-feather="send"></i>
                    <span>Telegram Bot</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <a href="/" class="back-to-main-btn">
                    <i data-feather="arrow-left-circle"></i>
                    <span>Asosiy Sahifaga</span>
                </a>
            </div>
        </aside>

        <!-- 2. ASOSIY KONTENT -->
        <main class="main-content">
            <!-- Bosh Sahifa (Dashboard) -->
            <section id="dashboard" class="page active">
                <h1 class="page-title">Boshqaruv Paneli</h1>
                <div class="stats-grid">
                    <!-- Bu kartalar JS orqali to'ldiriladi -->
                </div>
            </section>

            <!-- Interaktiv Hisobotlar (Pivot) -->
            <section id="pivot-reports" class="page">
                <div class="page-header">
                    <h1 class="page-title">Interaktiv Hisobotlar</h1>
                    <div class="template-controls">
                        <button id="save-template-btn" class="btn btn-secondary"><i data-feather="save"></i> Shablonni Saqlash</button>
                        <button id="load-templates-btn" class="btn btn-secondary"><i data-feather="folder"></i> Shablonlarni Ko'rish</button>
                    </div>
                </div>
                <p class="page-description">
                    Bu yerda siz barcha hisobotlarni tahlil qilishingiz, filtrlashingiz va o'zingizga kerakli ko'rinishda jamlanma (svod) olishingiz mumkin.
                </p>
                <div id="pivot-container"></div>
            </section>

            <!-- Foydalanuvchilarni Boshqarish -->
            <section id="users" class="page">
                <h1 class="page-title">Foydalanuvchilarni Boshqarish</h1>
                <div class="content-grid">
                    <div class="card">
                        <h3 class="card-title">Mavjud Foydalanuvchilar</h3>
                        <div class="user-list" id="user-list">
                            <!-- YUKLANISH HOLATI UCHUN SKELETON -->
                            <div class="skeleton-item"></div>
                            <div class="skeleton-item"></div>
                            <div class="skeleton-item"></div>
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="card-title">Yangi Foydalanuvchi Qo'shish</h3>
                        <form id="add-user-form">
                            <div class="form-group">
                                <label for="new-username">Login (username)</label>
                                <input type="text" id="new-username" class="form-control" placeholder="Foydalanuvchi logini">
                            </div>
                            <div class="form-group">
                                <label for="new-password">Parol</label>
                                <input type="password" id="new-password" class="form-control" placeholder="Kamida 8 belgi">
                            </div>
                            <div class="form-group">
                                <label for="new-user-role">Rol</label>
                                <select id="new-user-role" class="form-control">
                                    <option value="operator" selected>Operator</option>
                                    <option value="manager">Menejer</option>
                                    <option value="admin">Admin</option>
                                </select>
                            </div>
                            <div class="form-group" id="new-user-locations-group">
                                <label>Biriktirilgan filiallar:</label>
                                <div class="checkbox-grid" id="locations-checkbox-list">
                                    <!-- JS tomonidan to'ldiriladi -->
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary" id="add-user-btn"><i data-feather="user-plus"></i> Foydalanuvchi Qo'shish</button>
                        </form>
                    </div>
                </div>
            </section>

            <!-- Jadval Sozlamalari -->
            <section id="table-settings" class="page">
                <h1 class="page-title">Jadval Sozlamalari</h1>
                <div class="accordion-container">
                    <!-- Ustunlar -->
                    <div class="accordion-item">
                        <div class="accordion-header">
                            <h3 class="card-title">Ustunlar</h3>
                            <i data-feather="chevron-down" class="accordion-icon"></i>
                        </div>
                        <div class="accordion-content">
                            <div class="settings-list" id="columns-settings"></div>
                            <div class="add-item-form">
                                <input type="text" id="new-column-name" class="form-control" placeholder="Yangi ustun nomi...">
                                <button class="btn btn-secondary" id="add-column-btn"><i data-feather="plus"></i></button>
                            </div>
                        </div>
                    </div>
                    <!-- Qatorlar -->
                    <div class="accordion-item">
                        <div class="accordion-header">
                            <h3 class="card-title">Qatorlar</h3>
                            <i data-feather="chevron-down" class="accordion-icon"></i>
                        </div>
                        <div class="accordion-content">
                            <div class="settings-list" id="rows-settings"></div>
                            <div class="add-item-form">
                                <input type="text" id="new-row-name" class="form-control" placeholder="Yangi qator nomi...">
                                <button class="btn btn-secondary" id="add-row-btn"><i data-feather="plus"></i></button>
                            </div>
                        </div>
                    </div>
                    <!-- Filiallar -->
                    <div class="accordion-item">
                        <div class="accordion-header">
                            <h3 class="card-title">Filiallar</h3>
                            <i data-feather="chevron-down" class="accordion-icon"></i>
                        </div>
                        <div class="accordion-content">
                            <div class="settings-list" id="locations-settings"></div>
                            <div class="add-item-form">
                                <input type="text" id="new-location-name" class="form-control" placeholder="Yangi filial nomi...">
                                <button class="btn btn-secondary" id="add-location-btn"><i data-feather="plus"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="page-footer">
                    <button class="btn btn-primary" id="save-table-settings-btn"><i data-feather="save"></i> Jadval Sozlamalarini Saqlash</button>
                </div>
            </section>

            <!-- Telegram Bot Sozlamalari -->
            <section id="telegram" class="page">
                <h1 class="page-title">Telegram Bot Sozlamalari</h1>
                <div class="card" style="max-width: 600px;">
                    <h3 class="card-title">Botni Ulash</h3>
                    <div class="form-group">
                        <label for="bot-token">Bot Token</label>
                        <input type="text" id="bot-token" class="form-control" placeholder="BotFather bergan tokenni kiriting">
                    </div>
                    <div class="form-group">
                        <label for="group-id">Guruh ID</label>
                        <input type="text" id="group-id" class="form-control" placeholder="Guruh ID raqamini kiriting (minus bilan)">
                    </div>
                    <button class="btn btn-primary" id="save-telegram-btn"><i data-feather="save"></i> Telegram Sozlamalarini Saqlash</button>
                </div>
            </section>
        </main>
    </div>

    <!-- MODAL OYNALAR -->
    <!-- Shablonni saqlash uchun -->
    <div id="save-template-modal" class="modal hidden">
        <div class="modal-content">
            <button class="close-modal-btn" data-target="save-template-modal"><i data-feather="x"></i></button>
            <h3 class="modal-title">Shablonni Saqlash</h3>
            <p>Joriy hisobot ko'rinishini keyinchalik tezda ochish uchun unga nom bering.</p>
            <div class="form-group">
                <label for="template-name-input">Shablon nomi</label>
                <input type="text" id="template-name-input" class="form-control" placeholder="Masalan, 'Oylik tushum tahlili'">
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary close-modal-btn" data-target="save-template-modal">Bekor qilish</button>
                <button class="btn btn-primary" id="confirm-save-template-btn">Saqlash</button>
            </div>
        </div>
    </div>

    <!-- Shablonlarni yuklash uchun -->
    <div id="load-templates-modal" class="modal hidden">
        <div class="modal-content">
            <button class="close-modal-btn" data-target="load-templates-modal"><i data-feather="x"></i></button>
            <h3 class="modal-title">Saqlangan Shablonlar</h3>
            <p>Kerakli shablonni tanlab, uni yuklashingiz yoki o'chirishingiz mumkin.</p>
            <div id="template-list-container" class="template-list">
                <!-- JS tomonidan to'ldiriladi -->
            </div>
        </div>
    </div>

    <!-- Bildirishnoma (Toast) -->
    <div id="toast-notification" class="toast hidden"></div>
    
    <!-- JavaScript fayllari -->
    <script src="https://cdn.webdatarocks.com/latest/webdatarocks.toolbar.min.js"></script>
    <script src="https://cdn.webdatarocks.com/latest/webdatarocks.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="admin.js"></script>
</body>
</html>
